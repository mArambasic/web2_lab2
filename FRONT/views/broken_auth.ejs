<%- include('partials/header') -%>

<style>
    input[type="text"] {
      border: 1px solid #000000; 
      padding: 5px; 

    }
    .hint-box {
        margin-top: 10px;
        padding: 10px;
        border: 1px solid #ccc;
        background-color: #f9f9f9;
    }
</style>

<h1 class="text-4xl">Broken Authentication</h1>
<br>

<div class="hint-box">
    <p>Pressing use unsafe search allows.....</p>
</div>
<br>

<form action="login" method="post" onsubmit="return login()">
    Username: <input type="text" name="username" id="username"> 
    <br>
    Password: <input type="text" name="password" id="password">
    <br>
    <input type="submit" value="LOGIN" id="loginBtn">
    <input type="checkbox" name="unsafe" id="unsafeCheckbox"> Use Unsafe Search
</form>

<script>
    var loginAttempts = 0;

    function login() {
        var unsafeCheckbox = document.getElementById("unsafeCheckbox");
        if (unsafeCheckbox.checked) {
            login_unsafe();
        } else {
            login_safe();
        }
    }

    function login_unsafe() {
        loginAttempts++;

        var loginSucess = tryLogin()

        console.log("login unsafe");
    }

    function login_safe() {
        loginAttempts++;

        var loginSucess = tryLogin()

        if(!loginSucess && loginAttempts >= 5) {
            alert("Too many failed login attempts. Please wait 30 seconds before trying again.");

            document.getElementById("loginBtn").disabled = true;

            setTimeout(function() {
                document.getElementById("loginBtn").disabled = false;
                loginAttempts = 0;
            }, 30000); 
        }

        console.log("login safe");
    }

    function tryLogin() {
        console.log("trying to log in");
        return false;
    }
</script>



<%- include('partials/footer') -%>